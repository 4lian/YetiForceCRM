
jQuery.Class("Accounts_AccountsListTree_Js",{},{modalContainer:false,moduleFilter:false,treeInstance:false,treeData:false,getContainer:function(){if(this.modalContainer==false){this.modalContainer=jQuery("#centerPanel")}return this.modalContainer},setContainer:function(a){this.modalContainer=a},getRecords:function(b){if(this.treeData==false&&b!="undefined"){var a=b.find("#treePopupValues").val();this.treeData=JSON.parse(a)}return this.treeData},generateTree:function(a){var b=this;b.treeInstance=a.find("#treeContents");b.treeInstance.jstree({core:{data:b.getRecords(a),themes:{name:"proton",responsive:true}},plugins:["checkbox",]})},registerModulesChangeEvent:function(b){var a=this;if(a.moduleFilter){return}b.on("change","#moduleFilter",function(f){var d=jQuery(f.currentTarget);var c=d.val();a.getView("showTree",c).then(function(e){b.html(e);a.setContainer(b);a.registerEvents();app.changeSelectElementView(b.find("select"))})});a.moduleFilter=true},getView:function(g,b,c){var d=this;var a=jQuery.Deferred();var e=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var f={};f.module=app.getModuleName();f.view=app.getViewName();f.mode=g;f.selectedModule=b;f.selected=c;AppConnector.request(f).then(function(h){e.progressIndicator({mode:"hide"});a.resolve(h)},function(h){e.progressIndicator({mode:"hide"});a.reject()});return a.promise()},registerSelectElement:function(a){var c=this;var b=a.find("#moduleFilter").val();c.treeInstance.on("changed.jstree",function(g,f){var d=[];$.each(c.treeInstance.jstree("get_selected",true),function(e,h){d.push(h.text)});c.getView("showAccountsList",b,d).then(function(e){a.find("#accountsListContents").html(e)})})},registerEvents:function(){var a=this.getContainer();this.getRecords(a);this.generateTree(a);this.registerModulesChangeEvent(a);this.registerSelectElement(a)}});