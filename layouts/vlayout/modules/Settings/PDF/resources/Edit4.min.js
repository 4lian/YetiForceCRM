
Settings_PDF_Edit_Js("Settings_PDF_Edit4_Js",{},{step4Container:false,advanceFilterInstance:false,init:function(){this.initialize()},getContainer:function(){return this.step4Container},setContainer:function(a){this.step4Container=a;return this},initialize:function(a){if(typeof a==="undefined"){a=jQuery("#pdf_step4")}if(a.is("#pdf_step4")){this.setContainer(a)}else{this.setContainer(jQuery("#pdf_step4"))}},submit:function(){for(instance in CKEDITOR.instances){CKEDITOR.instances[instance].updateElement()}var b=jQuery.Deferred();var c=this.getContainer();var e=c.serializeFormData();var d=jQuery.progressIndicator({position:"html",blockInfo:{enabled:true}});var a=c.serializeFormData();a.action="Save";a.step=4;a.view="";AppConnector.request(a).then(function(f){f=JSON.parse(f);if(f.success==true){Settings_Vtiger_Index_Js.showMessage({text:app.vtranslate("JS_PDF_SAVED_SUCCESSFULLY")});AppConnector.request(e).then(function(g){c.hide();d.progressIndicator({mode:"hide"});b.resolve(g)},function(g,h){app.errorLog(g,h)})}},function(f,g){app.errorLog(f,g)});return b.promise()},registerCancelStepClickEvent:function(a){jQuery("button.cancelLink",a).on("click",function(){window.history.back()})},registerMainFieldsChangeEvent:function(b){var a=this;b.find('[name="main_fields"]').on("change",function(){a.updateMainFieldsValue(b);a.updateMainFieldsLabel(b)})},registerRelatedModuleChangeEvent:function(a){a.find('[name="related_module"]').on("change",function(){var b=a.find('[name="related_fields"]');var c={};c.data={parent:app.getParentModuleName(),module:app.getModuleName(),action:"GetMainFields",for_module:jQuery(this).val()};c.dataType="json";AppConnector.request(c).then(function(e){var d=e.result;if(e.success){b.prop("disabled",true);b.find("optgroup").remove();b.find("option").remove();for(var g in d){b.append('<optgroup label="'+g+'">');for(var f in d[g]){b.append('<option value="'+d[g][f]["name"]+'">'+d[g][f]["label"]+"</option>")}b.append("</optgroup>")}b.prop("disabled",false).trigger("liszt:updated");b.select2("val",b.find("option").first().val())}},function(e,d){app.errorLog(e,d)})})},registerRelatedFieldsChangeEvent:function(b){var a=this;b.find('[name="related_fields"]').on("change",function(){a.updateRelatedFieldsValue(b);a.updateRelatedFieldsLabel(b)})},registerCompanyFieldsChangeEvent:function(b){var a=this;b.find('[name="company_fields"]').on("change",function(){a.updateCompanyFieldsValue(b);a.updateCompanyFieldsLabel(b)})},updateMainFieldsValue:function(a){var b="$"+a.find('[name="main_fields"]').val()+"$";a.find("#mainFieldValue").val(b)},updateMainFieldsLabel:function(a){var b="%"+a.find('[name="main_fields"]').val()+"%";a.find("#mainFieldLabel").val(b)},updateRelatedFieldsValue:function(a){var b="$"+a.find('[name="related_module"]').val()+"_"+a.find('[name="related_fields"]').val()+"$";a.find("#relatedFieldValue").val(b)},updateRelatedFieldsLabel:function(a){var b="%"+a.find('[name="related_module"]').val()+"_"+a.find('[name="related_fields"]').val()+"%";a.find("#relatedFieldLabel").val(b)},updateCompanyFieldsValue:function(a){var b="$Company_"+a.find('[name="company_fields"]').val()+"$";a.find("#companyFieldValue").val(b)},updateCompanyFieldsLabel:function(a){var b="%Company_"+a.find('[name="company_fields"]').val()+"%";a.find("#companyFieldLabel").val(b)},registerCopyClipboard:function(a){var b=new ZeroClipboard(a,{moviePath:"libraries/jquery/ZeroClipboard/ZeroClipboard.swf"});b.on("complete",function(c,d){var e={text:app.vtranslate("LBL_NOTIFY_COPY_TEXT"),animation:"show",title:app.vtranslate("LBL_NOTIFY_COPY_TITLE"),type:"success"};Vtiger_Helper_Js.showPnotify(e)})},registerNewCkEditor:function(){CKEDITOR.replace("body_content",{disableNativeSpellChecker:true,scayt_autoStartup:false,removePlugins:"scayt"})},registerEvents:function(){var a=this.getContainer();var b=app.validationEngineOptions;b.onValidationComplete=function(d,c){return c};b.promptPosition="bottomRight";a.validationEngine(b);app.showSelect2ElementView(a.find(".chzn-select"));this.registerCancelStepClickEvent(a);this.registerRelatedModuleChangeEvent(a);this.registerMainFieldsChangeEvent(a);this.registerRelatedFieldsChangeEvent(a);this.registerCompanyFieldsChangeEvent(a);this.updateMainFieldsValue(a);this.updateMainFieldsLabel(a);this.updateRelatedFieldsValue(a);this.updateRelatedFieldsLabel(a);this.updateCompanyFieldsValue(a);this.updateCompanyFieldsLabel(a);this.registerNewCkEditor();this.registerCopyClipboard(a.find("#mainFieldsValueCopy"));this.registerCopyClipboard(a.find("#mainFieldsLabelCopy"));this.registerCopyClipboard(a.find("#relatedFieldsValueCopy"));this.registerCopyClipboard(a.find("#relatedFieldsLabelCopy"));this.registerCopyClipboard(a.find("#companyFieldsValueCopy"));this.registerCopyClipboard(a.find("#companyFieldsLabelCopy"));this.registerCopyClipboard(a.find("#specialFieldValueCopy"))}});